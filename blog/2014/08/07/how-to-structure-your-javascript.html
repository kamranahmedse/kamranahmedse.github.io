<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta name="viewport"
          content="width=device-width, user-scalable=yes, initial-scale=1.0, maximum-scale=3.0, minimum-scale=1.0">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>How to structure your Javascript</title>
    <meta name="description" content="Blog of a Software Engineer"/>
    <meta name="keywords" content="blog,developer blog,engineering blog"/>

    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Alegreya:400,400i|Lato:400,400i,700,900|Roboto+Mono:400,300">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/shades-of-purple.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>

    <link rel="stylesheet" href="/css/normalize.css"/>
    <link rel="stylesheet" href="/css/theme.css"/>
</head>
<body>
<nav class="nav">
    <div class="nav__left">
        <a href="/">Home</a>
        <a href="/about">About</a>
    </div>
    <div class="nav__right">
        <a target="_blank" href="https://github.com/kamranahmedse" class="link-github">GitHub</a>
        <a target="_blank" href="https://twitter.com/kamranahmedse" class="link-twitter">Twitter</a>
        <a href="mailto:kamranahmed.se@gmail.com" class="link-email">Email</a>
    </div>
</nav>

<article class="mar-b-7">
    <header class="text-center">
        <time class="mar-b-6" datetime="Thu, August 07, 2014">Thu, August 07, 2014</time>
        <h1 class="mar-b-7">How to structure your Javascript</h1>
    </header>
    <p>Being a full stack web developer, I have been toying around with pretty intensive jquery and ajax based web applications since the time I first started in web development. At Digitalsofts I developed a web based ERP system, along with it‚Äôs several versions for different domains, that made a heavy use of Javascript and Ajax and now at Strategic Systems International, I have been working upon an intensive health care application that again makes an intensive use of Javascript/Jquery and Ajax. Apart from the above mentioned projects, I have developed several other Javascript heavy applications e.g. <a href="http://goo.gl/5zfLa2">GCUF News Caster</a> and <a href="https://github.com/kamranahmedse/angularjs-todo">Toodloo</a> etc.</p>
<p>From my experience in Javascript, I have come to the point that it gives you a free hand and doesn‚Äôt enforce a particular structure on you. Now it is up to you to either make a unmanageable mess out of it, maintaining which would be a nightmare, or you can write a well structured code, maintaining which would be a breeze. It is important that you structure your Javascript, because:</p>
<ul>
<li>It‚Äôll make your code clean and consistent, so you‚Äôll know where to find what.</li>
<li>Done right, it would make your code easier to understand for others and of course for yourself as well when you‚Äôll revisit it later.</li>
<li>It will make your code testable.</li>
<li>Later on it‚Äôll make you feel proud ;-) ‚Ä¶and you‚Äôll feel compelled to use the best practices.</li>
</ul>
<p>So, let me start with how I structured my Javascript in ther ERP system that we talked about.</p>
<blockquote>
  <p>Please note that, there are several patterns to structure your Javascript, but I use Modular Pattern most of the time and that‚Äôs what I am going to explain in this article.</p>
</blockquote>
<h1 id="javascriptmodules">Javascript Modules</h1>
<p>In layman terms, I would explain the Javascript module as:</p>
<blockquote>
  <p>A chunk of related code having it‚Äôs own distinct meaning.</p>
</blockquote>
<p>For now, let‚Äôs keep it to that and I‚Äôd explain it a bit more later in the article. Now you may disagree with me, but that‚Äôs what I think of a Javascript module. Though, I‚Äôd love to hear your conflicting thoughts regarding Javascript Modules, if any, through your comments.</p>
<h1 id="decisionofmodules">Decision of Modules</h1>
<p>While developing the ERP system. The first step, that I took was the <strong>Decision of Modules.</strong> There were several usecases that were related to each other. Let‚Äôs take the example of <strong>Sale Transaction,</strong> for sale transaction there was a single voucher on which the <strong>New Transaction, Update Transaction, Remove Sale Transaction</strong> were being handled, So I thought to create a <em>module</em> called <strong>Sale</strong>. Another example would be, there was <strong>Sale Report</strong> that allowed the user to check the sales in some given date range and view the results that are grouped by <strong>item</strong>, <strong>voucher number</strong>, <strong>customer</strong> or <strong>date</strong> etc. Also in each grouping, a user can check a specific <strong>item</strong>, <strong>voucher</strong> or <strong>customer</strong>‚Äôs sale record and there was a search filter as well to allow the user to do a fuzzy search through the sales in each grouping etc. This all was to be handled on a single page, so I thought to create a <em>module</em> called <strong>SaleReport</strong>. In the same way, there were other modules in the application. You may say that Javascript modules that I decided were based upon the idea that related functionalities were to be kep in a single module, as I gave the examples of <strong>Sale</strong> and <strong>SaleReport</strong> module above.</p>
<h1 id="modularpatternexplained">Modular Pattern Explained</h1>
<p>Enough of the theory, let‚Äôs just dive into some Javascript to understand what exactly is the Modular Pattern and how can we use it to structure our code. A modular pattern can be implemented using many different variations, let‚Äôs get ourselves familiar with a really basic one.</p>
<p>It would be better, if we use some real world example in our explanation. So I‚Äôm going to use the example of a simple feed reader that reads and parses XML feed of some site. A module looks like the following:</p>
<pre><code class="javascript language-javascript">var FeedReader = {

};
</code></pre>
<p>Just a simple Javascript object, which you are probably already familiar with. For consistency in my code, I follow some conventions i.e. name of module to be written in Pascal Case and for variables etc, I prefer camel case. Now that we have a module to work with, the next is some settings that we‚Äôll define for this module.</p>
<pre><code class="javascript language-javascript">var FeedReader = {

    settings: {
        feedItemsCount: 10,
        url: 'http://someurl.com/news/feed/',
        feedListing: $('div#feedListing'),
        loadFeedButton: $('a.loadFeed')
    }
};
</code></pre>
<p>We usually define <code>settings</code> property in each of our modules that holds some common settings for our module so that we can use them to modify some certain behavior of our module actions. For example, as you can see from the settings that I have defined, <code>feedItemsCount</code> holds the number of feed items that we want to fetch in a single Ajax request. <code>url</code> is the url from which we want to read the feed. <code>feedListing</code> is the reference to DOM element to which the fetched feeds will be appended and <code>loadFeedButton</code> is the button which will fetch feed from the url.</p>
<p>The next most commong thing for a module is <code>init</code> function.</p>
<pre><code class="javascript language-javascript">var FeedReader = {

    settings: {
        feedItemsCount: 10,
        url: 'http://someurl.com/news/feed/',
        feedListing: $('div#feedListing'),
        loadFeedButton: $('a.loadFeed')
    },

    init: function () {
        FeedReader.showErrorIfSourceDead();
    },

    showErrorIfSourceDead : function () {
        if ( FeedReader.isSourceAlive( FeedReader.settings.url ) === false ) {
            alert("The URL provided can't be used to fetch feed.");
        }
    },

    isSourceAlive: function () {
        // ...
    }
};
</code></pre>
<p><code>init</code> is the function that gets everything started. You may call some setup functions here, for examples notice the function call <code>FeedReader.showErrorIfSourceDead();</code> that would show an error to the user stating that the website is not alive and to stop further processing. Now in the function <code>showErrorIfSourceDead();</code> notice the function call <code>FeedReader.isSourceAlive();</code>. As you can, see how managed the code is.</p>
<p>Next is, <code>bindUI</code> function to bind the user interface i.e. the place where all the event bindings take place.</p>
<pre><code class="javascript language-javascript">var FeedReader = {

    settings: {
        feedItemsCount: 10,
        url: 'http://someurl.com/news/feed/',
        feedListing: $('div#feedListing'),
        loadFeedButton: $('a.loadFeed')
    },

    init: function () {
        FeedReader.showErrorIfSourceDead();
        FeedReader.bindUI();
    },

    bindUI: function () {
        FeedReader.settings.loadFeedButton.on('click', function ( e ) {
            e.preventDefault();
            FeedReader.fetchFeed();
        });
    },

    showErrorIfSourceDead: function () {
        if ( FeedReader.isSourceAlive( FeedReader.settings.url ) === false ) {
            alert("The URL provided can't be used to fetch feed.");
        }
    },

    isSourceAlive: function () {
       // ...
    },

    fetchFeed: function () {
        // Fetch feed from the `FeedReader.settings.url`
        // Append the feed to the `FeedReader.settings.feedListing`
    }
};
</code></pre>
<p>You‚Äôll most commonly see the <code>bindUI</code> called in the <code>init</code> function of the module, as it is one of the most important part of the application as it sets up the event bindings etc that lets us interact with our application. As you can see in this example, we have fetched the <code>FeedReader.settings.loadFeed</code> button from the settings of the module and attached the <code>event</code> to this button. And then in click event we have called the <code>fetchFeed</code> function of the module that fetches feed from the <code>FeedReader.settings.url</code> and attaches the returned feed to <code>FeedReader.settings.feedListing</code> container.</p>
<p>In the same way, you can put all your functionality in a module.</p>
<h1 id="placementofmodules">Placement of Modules</h1>
<p>Instead of putting your Javascript code mudded with the HTML, place each of your module in a seaparate Javascript file with the name of the file same as the name of the module that it contains. For example, the <strong>Sale</strong> module will be placed in <strong>Sale.js</strong> and in the same way, <strong>SaleReport</strong> module will be placed in the <strong>SaleReport.js</strong> file. And each of the script will be included only the page where it will be needed.</p>
<p>Now that you have got the idea that you should have only one module per file, next step is the placement of these files i.e. where should these module files be placed. What I prefer is put them in my assets folder of my project. For example, usually my assets folder looks like:</p>
<p><img src="http://i.imgur.com/x6W43tn.png" alt="File Structure" /></p>
<p>Notice the js folder. All the plain javascript files will be placed in the root of <code>js</code> folder. Plugins and frameworks etc for example, twitter bootstrap, jquery etc will be placed in the <code>js/lib</code> folder. And Modules will be placed in the <code>js/modules</code> folder. Now it should be noted that the modules in the <code>js/modules</code> folder are further organized into sub folders. For example all the <code>Sale</code> related modules will be placed in <code>js/modules/sale</code> folder i.e. there would be <code>js/modules/sale/Sale.js</code> and <code>js/modules/sale/SaleReport.js</code> etc. In the same way the <code>Purchase</code> related modules will be placed in <code>js/modules/purchase</code> folder.</p>
<p>Now, the examples regarding and <code>Sales</code> and <code>Purchases</code> etc might seem daunting to you, so let me just quote a simple Blog related examples. There would be two folders inside the module i.e. <code>js/modules/blog</code> folder to hold all the blog related javascript modules and <code>js/modules/user</code> to hold all the users related javascript modules. For Example there can be <code>js/modules/blog/Post.js</code>, <code>js/modules/blog/Comment.js</code> etc in the <code>js/modules/blog</code> folder and <code>js/modules/user/User.js</code> etc in the <code>js/modules/user</code> folder.</p>
<h1 id="usingthecreatedmodules">Using the created Modules</h1>
<p>Now that we have created our module, it‚Äôs time to understand how to use it in our application. It‚Äôs as simple as the following:</p>
<pre><code class="html language-html">&amp;lt;html&amp;gt;
    &amp;lt;!--- All of your markup --&amp;gt;

    &amp;lt;!-- Include your modules in this HTML page. For Example --&amp;gt;
    &amp;lt;script src="js/modules/FeedReader.js"&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script src="js/modules/SomeOtherModule.js"&amp;gt;&amp;lt;/script&amp;gt;

    &amp;lt;!-- Fire your module --&amp;gt;

    &amp;lt;script&amp;gt;
        (function ( ) {
            FeedReader.init();
            SomeOtherModule.init();
        }());
    &amp;lt;/script&amp;gt;
&amp;lt;/html&amp;gt;
</code></pre>
<h1 id="conclusion">Conclusion</h1>
<p>From our discussion above, I expect that you have understood how and why should we structure our Javascript. And as we discussed above:</p>
<ul>
<li>Our code is clean and consistent. All the settings are at a separate place, event bindings have their own place etc.</li>
<li>Our code is easily understandable. As you can see, we can start through the init function and can easily see what‚Äôs happening.</li>
<li>It will make your code testable. Well we haven‚Äôt discussed much regarding this but I promise to cover it in some article later.</li>
<li>And for the last point ‚ÄúLater on it‚Äôll make you feel proud ‚Ä¶and compelled to use the best practices.‚Äù. Well, believe me, I am feeling proud right now ;-) Go build something great using what you have learnt and see if you feel proud of what you just wrote ;-)</li>
</ul>
<p>And, as I already said.. We have just scratched the surface of it. For further detail of Modular Patter, I‚Äôll refer you to <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript">this topic of Addy Osmani's Book</a> - <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/">Essential JS Design Patterns</a></p>
</article>


    <section id="mc_embed_signup" class="mar-tb-7 twitter-signup">
        <div class="mc-title-container"></div>

        <p class="mar-0 twitter-signup-text">üëã <a href="http://twitter.com/kamranahmedse"
                                                   target="_blank">Follow me on
                twitter</a> for the updates. </p>
    </section>


<footer class="text-center mar-tb-6">
    ¬© 2023 Kamran Ahmed, unless otherwise stated.
</footer>

<script>hljs.highlightAll();</script>
</body>
</html>

